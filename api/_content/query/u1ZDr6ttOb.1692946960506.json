[{"_path":"/blog/javascript/js","_dir":"javascript","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"JS中的防抖和节流","description":"JS中的防抖和节流。","slug":"Anti-shake-and-throttling-in-JavaScript","category":"javascript","createtime":"2023-08-23 09:56","cover":"/images/content/cover/javascript.png","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"js中的防抖和节流"},"children":[{"type":"text","value":"JS中的防抖和节流"}]},{"type":"element","tag":"h2","props":{"id":"防抖"},"children":[{"type":"text","value":"防抖"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"n 秒后再执行该事件，若在 n 秒内被重复触发，则重新计时。"}]},{"type":"element","tag":"code","props":{"className":["language-javascript"],"code":"/**\n * 防抖函数\n * @param {*} cb 回调函数，要执行的操作\n * @param {*} delay 延时时间\n */\nconst debounce = (cb, delay = 1000) => {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => {\n      cb(...args, delay);\n    });\n  };\n};\n","language":"javascript","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":"/**\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" * 防抖函数\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" * "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-118310"},"children":[{"type":"text","value":"{*}"}]},{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"cb"}]},{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" 回调函数，要执行的操作\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" * "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-118310"},"children":[{"type":"text","value":"{*}"}]},{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"delay"}]},{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" 延时时间\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-080019"},"children":[{"type":"text","value":" */\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"debounce"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-818538"},"children":[{"type":"text","value":"cb"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-818538"},"children":[{"type":"text","value":"delay"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-390898"},"children":[{"type":"text","value":"1000"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" timeout;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-818538"},"children":[{"type":"text","value":"args"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"clearTimeout"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"(timeout);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    timeout "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"setTimeout"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"(() "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"cb"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"args, delay);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  };\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"};"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"节流"},"children":[{"type":"text","value":"节流"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"n 秒内只运行一次，若在 n 秒内重复触发，只有一次生效"}]},{"type":"element","tag":"code","props":{"className":["language-javascript"],"code":"const throttle = (cb, delay = 1000) => {\n  let isWaiting = false;\n  let lastArgs;\n\n  const timeOutFn = () => {\n    if (lastArgs) {\n      cb(...lastArgs);\n      lastArgs = null;\n      setTimeout((timeOutFn, delay));\n    } else {\n      isWaiting = false;\n    }\n  };\n\n  return (...args) => {\n    if (isWaiting) {\n      lastArgs = args;\n      return;\n    }\n    cb(...args);\n    isWaiting = true;\n    setTimeout((timeOutFn, delay));\n  };\n};\n","language":"javascript","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"throttle"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-818538"},"children":[{"type":"text","value":"cb"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-818538"},"children":[{"type":"text","value":"delay"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-390898"},"children":[{"type":"text","value":"1000"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" isWaiting "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-390898"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" lastArgs;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"timeOutFn"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" () "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" (lastArgs) {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"cb"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"lastArgs);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      lastArgs "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-390898"},"children":[{"type":"text","value":"null"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"setTimeout"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"((timeOutFn, delay));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    } "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"else"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      isWaiting "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-390898"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  };\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-818538"},"children":[{"type":"text","value":"args"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" (isWaiting) {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      lastArgs "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" args;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"cb"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"args);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    isWaiting "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-390898"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"setTimeout"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"((timeOutFn, delay));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  };\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"};"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-080019{color:#6A737D;}\n.sepia .ct-080019{color:#88846F;}\n.ct-391872{color:#D73A49;}\n.dark .ct-391872{color:#F97583;}\n.sepia .ct-391872{color:#66D9EF;font-style:italic;}\n.ct-118310{color:#6F42C1;}\n.dark .ct-118310{color:#B392F0;}\n.sepia .ct-118310{color:#A6E22E;text-decoration:bold;}\n.ct-248813{color:#24292E;}\n.dark .ct-248813{color:#E1E4E8;}\n.sepia .ct-248813{color:#F8F8F2;}\n.ct-118306{color:#6F42C1;}\n.dark .ct-118306{color:#B392F0;}\n.sepia .ct-118306{color:#A6E22E;}\n.ct-257789{color:#D73A49;}\n.dark .ct-257789{color:#F97583;}\n.sepia .ct-257789{color:#F92672;}\n.ct-818538{color:#E36209;}\n.dark .ct-818538{color:#FFAB70;}\n.sepia .ct-818538{color:#FD971F;font-style:italic;}\n.ct-390898{color:#005CC5;}\n.dark .ct-390898{color:#79B8FF;}\n.sepia .ct-390898{color:#AE81FF;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"防抖","depth":2,"text":"防抖"},{"id":"节流","depth":2,"text":"节流"}]}},"_type":"markdown","_id":"content:blog:javascript:JS中的防抖和节流.md","_source":"content","_file":"blog/javascript/JS中的防抖和节流.md","_extension":"md"},{"_path":"/blog/javascript/js","_dir":"javascript","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"JS中的深拷贝","description":"JS中的深拷贝。","slug":"deep-clone-in-JavaScript","category":"javascript","createtime":"2023-08-23 10:05","cover":"/images/content/cover/javascript.png","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"js中的深拷贝"},"children":[{"type":"text","value":"JS中的深拷贝"}]},{"type":"element","tag":"h2","props":{"id":"深拷贝解决了什么问题"},"children":[{"type":"text","value":"深拷贝解决了什么问题？"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 JavaScript 中的数据类型分为"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"基本数据类型"}]},{"type":"text","value":"和"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"引用数据类型"}]},{"type":"text","value":"，基本数据类型的值存储在栈中，变量存储的是值，而引用数据类型的值存储在堆中，变量存储的是值在堆中的引用地址。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"对于赋值操作（let b =  a），分为两种情况："}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"如果 a 为基本数据类型，则直接将 a 在栈中的值复制一份给 b，后续再对 a 进行改值操作，不会影响到 b 的值"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"如果 a 为引用数据类型，则会将 a 存储的引用地址复制给 b ，此时相当于 a 和 b 的值同时依赖于该引用地址在堆内存中所代表的的值，无论是 a 或是 b 对该引用地址的值进行操作，都会影响到另一个变量。"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果现在有一个变量为 obj1 和另一个变量 obj2 ，obj1 的数据类型为对象，需要将 obj1 的值“拷贝”一份到 obj2 中，且改变其中任意一个变量的值都不能影响到另外一个对象，该“拷贝”操作则被称为"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"深拷贝"}]},{"type":"text","value":"。"}]},{"type":"element","tag":"h2","props":{"id":"深拷贝的方法"},"children":[{"type":"text","value":"深拷贝的方法"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在以下方法钟，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"original"}]},{"type":"text","value":" 表示被拷贝的对象（源对象），"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"target"}]},{"type":"text","value":" 表示拷贝到的对象（目标对象）。"}]},{"type":"element","tag":"h4","props":{"id":"_1-通过-es6-新加入的拓展运算符"},"children":[{"type":"text","value":"1. 通过 ES6 新加入的拓展运算符"}]},{"type":"element","tag":"code","props":{"className":["language-javascript"],"code":"let target = {...original}\n","language":"javascript","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" target "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"original}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"注意：源对象中不能包含对象类型参数。"}]},{"type":"element","tag":"h4","props":{"id":"_2-通过-objectassign-对象"},"children":[{"type":"text","value":"2. 通过 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Object.assign"}]},{"type":"text","value":" 对象"}]},{"type":"element","tag":"code","props":{"className":["language-javascript"],"code":"let target = Object.assign({},original)\n","language":"javascript","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" target "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" Object."}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"assign"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"({},original)"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"注意：源对象中不能包含对象类型参数。"}]},{"type":"element","tag":"h4","props":{"id":"_3-通过-jsonparse-和-jsonstringify"},"children":[{"type":"text","value":"3. 通过 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"JSON.parse"}]},{"type":"text","value":" 和 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"JSON.stringify"}]}]},{"type":"element","tag":"code","props":{"className":["language-javascript"],"code":"let target = JSON.parse(JSON.stringify(original))\n","language":"javascript","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" target "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-900255"},"children":[{"type":"text","value":"JSON"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"parse"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-900255"},"children":[{"type":"text","value":"JSON"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"stringify"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"(original))"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"注意：源对象中不能有如下类型：Date, functions, undefined, Infinity, RegExps, Maps, Sets, Blobs, FileLists, ImageDatas, sparse Arrays"}]},{"type":"element","tag":"h4","props":{"id":"_4-自定义函数"},"children":[{"type":"text","value":"4. 自定义函数"}]},{"type":"element","tag":"code","props":{"className":["language-javascript"],"code":"function deepClone(target,original) { \n  for(let k in original){\n    if(typeof original[k] === \"object\"){\n      target[k] = {}\n      deepClone(target[k],original[k])\n    }else{\n      target[k] = original[k]\n    }\n  }\n}\n","language":"javascript","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"deepClone"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-818538"},"children":[{"type":"text","value":"target"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-818538"},"children":[{"type":"text","value":"original"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":") { \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-391872"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" k "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" original){\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"typeof"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" original[k] "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-088893"},"children":[{"type":"text","value":"\"object\""}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"){\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      target[k] "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" {}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-118306"},"children":[{"type":"text","value":"deepClone"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"(target[k],original[k])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    }"}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"else"}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"      target[k] "}]},{"type":"element","tag":"span","props":{"class":"ct-257789"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":" original[k]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-248813"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-391872{color:#D73A49;}\n.dark .ct-391872{color:#F97583;}\n.sepia .ct-391872{color:#66D9EF;font-style:italic;}\n.ct-248813{color:#24292E;}\n.dark .ct-248813{color:#E1E4E8;}\n.sepia .ct-248813{color:#F8F8F2;}\n.ct-257789{color:#D73A49;}\n.dark .ct-257789{color:#F97583;}\n.sepia .ct-257789{color:#F92672;}\n.ct-118306{color:#6F42C1;}\n.dark .ct-118306{color:#B392F0;}\n.sepia .ct-118306{color:#A6E22E;}\n.ct-900255{color:#005CC5;}\n.dark .ct-900255{color:#79B8FF;}\n.sepia .ct-900255{color:#F8F8F2;}\n.ct-818538{color:#E36209;}\n.dark .ct-818538{color:#FFAB70;}\n.sepia .ct-818538{color:#FD971F;font-style:italic;}\n.ct-088893{color:#032F62;}\n.dark .ct-088893{color:#9ECBFF;}\n.sepia .ct-088893{color:#E6DB74;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"深拷贝解决了什么问题","depth":2,"text":"深拷贝解决了什么问题？"},{"id":"深拷贝的方法","depth":2,"text":"深拷贝的方法"}]}},"_type":"markdown","_id":"content:blog:javascript:JS中的深拷贝.md","_source":"content","_file":"blog/javascript/JS中的深拷贝.md","_extension":"md"}]